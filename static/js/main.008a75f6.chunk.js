(this.webpackJsonpspotify_application=this.webpackJsonpspotify_application||[]).push([[0],{104:function(e,t,a){"use strict";a.r(t);var c=a(0),s=a.n(c),n=a(34),i=a.n(n),r=(a(65),a(66),a(13)),l=a(18),o=Object(l.a)({name:"authorization",initialState:{loggedIn:!1,accessToken:"",tokenExpiryDate:""},reducers:{setLoggedIn:function(e,t){e.loggedIn=t.payload},setAccessToken:function(e,t){e.accessToken=t.payload},setTokenExpiryDate:function(e,t){var a=new Date;a.setSeconds(a.getSeconds()+t.payload),e.tokenExpiryDate=a.toISOString()}}}),d=o.actions,u=d.setLoggedIn,j=d.setAccessToken,b=(d.setUserId,d.setTokenExpiryDate),p=function(e){return e.authorization.loggedIn},m=o.reducer,h=Object(l.a)({name:"user",initialState:{displayName:"",userId:"",product:"",recentlyPlayed:[]},reducers:{setDisplayName:function(e,t){e.displayName=t.payload},setUserId:function(e,t){e.userId=t.payload},setProduct:function(e,t){e.product=t.payload},setRecentlyPlayed:function(e,t){e.recentlyPlayed=t.payload}}}),O=h.actions,f=O.setDisplayName,y=O.setUserId,x=O.setProduct,_=(O.setRecentlyPlayed,h.reducer,{url:{API_URL:"https://mathieu94110.github.io/My_spotify-app/"}}),v=a(3),g=(a(70),a(1)),N=window.location.hash.substring(1).split("&").reduce((function(e,t){if(t){var a=t.split("=");e[a[0]]=decodeURIComponent(a[1])}return e}),{}),k=N.access_token,I=N.expires_in;window.history.pushState("",document.title,window.location.pathname+window.location.search);var S=function(){var e=Object(r.d)(p),t=Object(r.c)();return Object(c.useEffect)((function(){var e;k&&(localStorage.setItem("accessToken",k),t(u(!0)),t(j(k)),t(b(Number(I))),t((e=k,function(t){var a=new Headers;a.append("Authorization","Bearer "+e),fetch("https://api.spotify.com/v1/me",{method:"GET",headers:a}).then((function(e){return e.json()})).then((function(e){t(f(e.display_name?e.display_name:"")),t(y(e.id)),localStorage.setItem("userId",e.id),t(x(e.product))})).catch((function(e){console.log(e),e&&401===e.status&&t(u(!1))}))})))}),[]),Object(g.jsxs)("div",{className:"login",children:[!e&&Object(g.jsx)("button",{className:"login__button","aria-label":"Log in using OAuth 2.0",onClick:function(){return window.open(function(){var e=_.url.API_URL;return"".concat("https://accounts.spotify.com/authorize","?client_id=").concat("883cad702d5c446f9f5bfa7637b2997b","&redirect_uri=").concat(e,"&scope=").concat(["user-read-private","playlist-modify-public","playlist-modify-private","user-read-recently-played","user-top-read"].join("%20"),"&response_type=token")}(),"_self")},children:"Se connecter"}),e&&Object(g.jsx)(v.a,{replace:!0,to:"/home"})]})},T=(a(72),a(20)),w=function(e){return e.user},P=Object(T.a)([w],(function(e){return e.isLoading})),C=Object(T.a)([w],(function(e){return e.data})),A=a(37),L=a.n(A),E=A.create({baseURL:"https://api.spotify.com/v1/"}),R=function(){if(localStorage.getItem("accessToken"))return localStorage.getItem("accessToken")}();E.interceptors.request.use((function(e){return e.headers.Authorization="Bearer ".concat(R),e}));var D=function(){return E.get("me/player/recently-played").then((function(e){return e.data.items?e.data.items:[]}))},U="request last activity",z="fetch last activity success",B="fetch last activity error",H=(a(89),function(e){Object(c.useEffect)((function(){console.log(e)}),[]);return Object(g.jsxs)("div",{className:"recently-played",children:[Object(g.jsx)("h2",{className:"recently-played__title",children:"\xc9cout\xe9 derni\xe8rement"}),Object(g.jsx)("div",{className:"recently-played__content",children:e.songs&&e.songs.map((function(e){return Object(g.jsxs)("div",{className:"recently-played__items",children:[Object(g.jsx)("p",{children:Object(g.jsx)("img",{src:e.track.album.images[2].url,alt:"",style:{width:"60px"}})}),Object(g.jsx)("p",{className:"recently-played__track-name",children:e.track.name}),Object(g.jsx)("p",{children:(t=e.track.duration_ms,Math.floor(t/6e4)+":"+t%60)}),Object(g.jsx)("p",{children:new Date(e.played_at).toLocaleDateString("fr")})]},e.track.id);var t}))})]})}),q=function(){return Object(g.jsx)("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",width:"100%"},children:Object(g.jsx)("img",{alt:"loading gif",src:"https://i.redd.it/ounq1mw5kdxy.gif"})})},V=Object(r.b)((function(e){return{isLoading:P(e),user:C(e)}}),{getLastActivity:function(){return function(e){return e({type:U}),D().then((function(t){return e(function(e){return{type:z,user:e}}(t))}),(function(t){return e(function(e){return{type:B,error:e}}(t))}))}}})((function(e){return Object(c.useEffect)((function(){e.getLastActivity()}),[]),Object(g.jsx)(g.Fragment,{children:e.isLoading?Object(g.jsx)(q,{}):Object(g.jsxs)("div",{className:"home",children:[Object(g.jsxs)("h1",{className:"home__title",children:["Bienvenue"," ",", vous \xeates bien connect\xe9 sur votre plateforme Spotify"]}),Object(g.jsx)(H,{songs:e.user})]})})})),G=a(21),M=a(4),W=(a(90),function(){if(localStorage.getItem("accessToken"))return localStorage.getItem("accessToken")}),F=function(){if(localStorage.getItem("userId"))return localStorage.getItem("userId")},J=Object(l.a)({name:"playlists",initialState:{playlistsItems:[],total:0},reducers:{setPlaylistsItem:function(e,t){e.playlistsItems=t.payload},setTotal:function(e,t){e.total=t.payload}}}),$=J.actions,K=$.setPlaylistsItem,Q=$.setTotal,X=function(e){return e.playlists.playlistsItems},Y=function(){return function(e){var t=W(),a=F(),c=new Headers;c.append("Authorization","Bearer "+t),fetch("https://api.spotify.com/v1/users/"+a+"/playlists",{method:"GET",headers:c}).then((function(e){return e.json()})).then((function(t){e(K(t.items)),e(Q(t.total))})).catch((function(e){console.log(e)}))}},Z=J.reducer,ee=(a(91),a(92),function(e){var t=e.image,a=e.uri,c=e.name,s=e.description,n=e.details,i={background:"url("+t+") center center no-repeat",maxWidth:"100%"};return Object(g.jsxs)("div",{className:"card",children:[Object(g.jsx)("header",{style:i,id:t,className:"card__header"}),Object(g.jsxs)("div",{className:"card__body",children:[Object(g.jsxs)("p",{className:"card__date",children:["Lien: ",Object(g.jsx)("a",{href:a,children:a})]}),Object(g.jsx)("h2",{children:c}),Object(g.jsx)("p",{className:"card__content",children:s||"Aucune description"}),n&&Object(g.jsxs)("button",{className:"button card__button-primary",children:[Object(g.jsx)("i",{className:"fa fa-chevron-right"})," Voir le d\xe9tail"]})]})]})}),te=function(){var e=Object(r.d)(X),t=Object(r.c)();return Object(c.useEffect)((function(){t(Y())}),[]),Object(g.jsxs)("div",{className:"user-playlists",children:[Object(g.jsxs)("div",{className:"user-playlists__title",children:[" ",Object(g.jsx)("h2",{children:"Vos playlists"})]}),Object(g.jsx)("div",{className:"user-playlists__content",children:e&&e.map((function(e,t){return Object(g.jsx)("div",{children:Object(g.jsx)(ee,{image:e.images[0]&&e.images[0].url,uri:e.uri,name:e.name,description:e.description,details:"true"})},t)}))})]})};a(93);function ae(e){var t=e.createPlayList,a=e.cancelPlaylistCreation,s=e.confirmPlaylistCreation,n=Object(c.useState)(""),i=Object(M.a)(n,2),r=i[0],l=i[1],o=Object(c.useState)(""),d=Object(M.a)(o,2),u=d[0],j=d[1],b=Object(c.useState)(!1),p=Object(M.a)(b,2),m=p[0],h=p[1],O=function(){l(""),j(""),a(),h(!1)};return Object(g.jsxs)("div",{className:"create-playlist",children:[Object(g.jsx)("div",{className:"create-playlist__title",children:Object(g.jsx)("h2",{children:"Cr\xe9er une playlist"})}),Object(g.jsx)("div",{className:"create-playlist__form-container",children:Object(g.jsxs)("form",{className:"create-playlist__form",onSubmit:function(e){e.preventDefault(),t({name:r,description:u}),h(!0)},children:[Object(g.jsxs)("label",{className:"create-playlist__form-label",children:["Nom:",Object(g.jsx)("input",{type:"text",id:"outlined-basic",className:"create-playlist__form-inputs",name:"name",value:r,onChange:function(e){return l(e.target.value)},disabled:m})]}),Object(g.jsxs)("label",{className:"create-playlist__form-label",children:["Description:",Object(g.jsx)("textarea",{type:"text",id:"outlined-basic",className:"create-playlist__form-inputs",name:"description",value:u,onChange:function(e){return j(e.target.value)},disabled:m})]}),m?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("input",{className:"create-playlist__button create-playlist__button-validate",type:"button",value:"Valider la playlist",onClick:function(){return s(),void O()}}),Object(g.jsx)("input",{className:"create-playlist__button create-playlist__button-cancel",type:"button",value:"Annuler",onClick:function(){return O()}})]}):Object(g.jsx)("input",{className:"create-playlist__button create-playlist__button-create",type:"submit",value:"Cr\xe9er la playlist",disabled:!r||!u})]})})]})}a(94);var ce=function(e){var t=e.name,a=e.description,c=e.image,s=e.uri,n=e.details;return Object(g.jsxs)("div",{className:"create-playlist-model",children:[Object(g.jsxs)("div",{className:"create-playlist-model__title",children:[" ",Object(g.jsx)("h2",{children:"R\xe9capitulatif"})]}),Object(g.jsx)("div",{className:"create-playlist-model__content",children:Object(g.jsx)(ee,{image:c,uri:s,name:t,description:a,details:n})})]})},se=a(16),ne=(a(53),function(){var e=Object(c.useState)({}),t=Object(M.a)(e,2),a=t[0],s=t[1],n=Object(c.useState)(!1),i=Object(M.a)(n,2),l=i[0],o=(i[1],Object(r.c)());return Object(g.jsxs)("div",{className:"playlists",children:[Object(g.jsxs)("div",{className:"playlists__content",children:[Object(g.jsx)(te,{}),Object(g.jsx)(ae,{createPlayList:function(e){s(e)},cancelPlaylistCreation:function(){s({})},setCreateDisabled:l,confirmPlaylistCreation:function(){var e;o((e=a,function(t){var a=e.name,c=e.description,s=W(),n=F(),i=new Headers;return i.append("Authorization","Bearer "+s),fetch("https://api.spotify.com/v1/users/".concat(n,"/playlists"),{method:"POST",headers:i,body:JSON.stringify({name:a,description:c})}).then((function(e){if(e.ok)return e.json();throw new Error("Request failed!")}),(function(e){console.log(e.message)}))})).then((function(){se.b.success("La playlist a bien \xe9t\xe9 cr\xe9ee !",{position:se.b.POSITION.TOP_RIGHT})})).catch((function(e){se.b.error("".concat(e.message," !"),{position:se.b.POSITION.TOP_CENTER})}))}}),a.name&&Object(g.jsx)(ce,{name:a.name,description:a.description})]}),Object(g.jsx)(se.a,{})]})}),ie=a(26),re=(a(95),a(96),function(e){var t=e.track,a=e.modalCallback;return Object(g.jsxs)("div",{className:"search-result-item",children:[Object(g.jsxs)("span",{className:"search-result-item__image",children:[Object(g.jsx)("img",{src:t.albumUrl})," "]}),Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{children:[" ",Object(g.jsx)("span",{className:"search-result-item__text",children:t.title})]}),Object(g.jsxs)("div",{children:[" ",Object(g.jsx)("span",{className:"search-result-item__artist",children:t.artist})]}),Object(g.jsx)("button",{className:"search-result-item__button",onClick:function(){a(t)},children:"+"})]})]})}),le=function(e){var t=e.searchResults,a=e.modalCallback;return Object(g.jsx)("div",{className:"search-result",children:t.map((function(e,t){return Object(g.jsx)(re,{track:e,modalCallback:a},t)}))})},oe=(a(97),function(e){var t=e.setIsOpen,a=e.playlists,s=e.track,n=e.addTrackToPlaylist,i=Object(c.useState)(!1),r=Object(M.a)(i,2),l=r[0],o=r[1];return Object(g.jsx)(g.Fragment,{children:Object(g.jsx)("div",{className:"add-track-modal",children:Object(g.jsxs)("div",{className:"add-track-modal__modal",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{className:"add-track-modal__title",children:"Ajouter le titre \xe0 une playlist"}),Object(g.jsx)("div",{className:"add-track-modal__subtitle",children:"S\xe9lectionner la playlist"})]}),Object(g.jsx)("div",{className:"add-track-modal__playlists",children:a&&a.map((function(e,t){return Object(g.jsxs)("div",{className:"add-track-modal__playlists-items",children:[Object(g.jsx)("span",{children:e.name})," ",Object(g.jsx)("input",{type:"checkbox",value:e.id,checked:l===e,onChange:function(){o(e)}})]},t)}))}),Object(g.jsx)("div",{children:Object(g.jsxs)("div",{className:"add-track-modal__actions",children:[Object(g.jsx)("button",{className:"cancel-button",onClick:function(){return t(!1)},children:"Annuler"}),Object(g.jsx)("button",{className:"validate-button",onClick:function(){n(s,l)},children:"Valider"})]})})]})})})}),de=(a(98),["title","uri"]),ue=["id","name"],je=function(){var e=localStorage.getItem("accessToken"),t=Object(c.useState)(""),a=Object(M.a)(t,2),s=a[0],n=a[1],i=Object(c.useState)([]),l=Object(M.a)(i,2),o=l[0],d=l[1],u=Object(c.useState)(!1),j=Object(M.a)(u,2),b=j[0],p=j[1],m=Object(c.useState)(""),h=Object(M.a)(m,2),O=h[0],f=h[1],y=Object(r.d)(X),x=Object(r.c)();Object(c.useEffect)((function(){x(Y())}),[]);var _=function(e){return f(e),p(!b)};Object(c.useEffect)((function(){if(!s)return d([]);var t={headers:{Authorization:"Bearer ".concat(e)},params:{q:s,type:"track"}};L.a.get("https://api.spotify.com/v1/search",t).then((function(e){d(e.data.tracks.items.map((function(e){var t=e.album.images.reduce((function(e,t){return t.height<e.height?t:e}),e.album.images[0]);return{artist:e.artists[0].name,title:e.name,uri:e.uri,albumUrl:t.url}})))}))}),[s]);return Object(g.jsxs)("div",{className:"search",children:[Object(g.jsx)("input",{className:"search__input",type:"search",placeholder:"Rechercher un titre",value:s,onChange:function(e){return n(e.target.value)}}),Object(g.jsx)(le,{searchResults:o,modalCallback:_}),b&&Object(g.jsx)(oe,{setIsOpen:_,playlists:y,track:O,addTrackToPlaylist:function(e,t){var a,c=e.title,s=e.uri,n=(Object(ie.a)(e,de),t.id),i=t.name;Object(ie.a)(t,ue);x((a={uri:s,id:n},function(e){var t=a.uri,c=a.id,s=W(),n=new Headers;return n.append("Authorization","Bearer "+s),fetch("https://api.spotify.com/v1/playlists/".concat(c,"/tracks?uris=").concat(t),{method:"POST",headers:n}).then((function(e){if(e.ok)return e.json();throw new Error("Request failed!")}),(function(e){console.log(e.message)}))})).then((function(){se.b.success("".concat(c," a bien \xe9t\xe9 ajout\xe9 \xe0 ").concat(i," !"),{position:se.b.POSITION.TOP_RIGHT})})).catch((function(e){se.b.error("".concat(e.message," !"),{position:se.b.POSITION.TOP_CENTER})})).finally((function(){_()}))}}),Object(g.jsx)(se.a,{})]})},be=(a(99),a.p+"static/media/spotify-logo.056948ef.png"),pe=a(39),me=a(38),he=a(58),Oe=a.n(he),fe=a(57),ye=a.n(fe);function xe(){var e=Object(c.useState)(!0),t=Object(M.a)(e,2),a=t[0],s=t[1];return Object(g.jsx)("div",{children:Object(g.jsx)("div",{className:a?"sidebar":"sidebar sidebar--closed",children:Object(g.jsxs)("div",{className:"sidebar__top-links",children:[Object(g.jsx)("div",{className:"sidebar__logo",children:Object(g.jsx)("img",{src:be,alt:"spotify",className:a?"sidebar__logo-img":"sidebar__logo-img sidebar__logo-img--closed"})}),Object(g.jsx)("button",{className:a?"sidebar__menu-toggle":"sidebar__menu-toggle sidebar__menu-toggle--closed",onClick:function(){s(!a)},children:a?Object(g.jsx)(ye.a,{}):Object(g.jsx)(Oe.a,{})}),Object(g.jsxs)("ul",{className:"sidebar__list-items",children:[Object(g.jsx)("li",{children:Object(g.jsxs)(G.b,{to:"/home",className:"sidebar__nav-link",children:[Object(g.jsx)("span",{children:Object(g.jsx)(pe.a,{icon:me.b})}),Object(g.jsx)("span",{className:a?"sidebar__text-display":"sidebar__text-display-none",children:"Accueil"})]})}),Object(g.jsx)("li",{children:Object(g.jsxs)(G.b,{to:"/search",className:"sidebar__nav-link",children:[Object(g.jsx)("span",{children:Object(g.jsx)(pe.a,{icon:me.c})}),Object(g.jsx)("span",{className:a?"sidebar__text-display":"sidebar__text-display-none",children:"Rechercher"})]})}),Object(g.jsx)("li",{children:Object(g.jsxs)(G.b,{to:"/playlists",className:"nav-link",children:[Object(g.jsx)("span",{children:Object(g.jsx)(pe.a,{icon:me.a})}),Object(g.jsxs)("span",{className:a?"sidebar__text-display":"sidebar__text-display-none",children:[" ","Vos playlists"]})]})})]})]})})})}var _e=function(){var e=Object(r.d)(p);return Object(g.jsx)(G.a,{children:Object(g.jsxs)("div",{className:"App",children:[e?Object(g.jsx)(xe,{}):null,Object(g.jsxs)(v.d,{children:[Object(g.jsx)(v.b,{exact:!0,path:"/",element:Object(g.jsx)(S,{})}),Object(g.jsx)(v.b,{exact:!0,path:"/playlists",element:Object(g.jsx)(ne,{})}),Object(g.jsx)(v.b,{exact:!0,path:"/home",element:Object(g.jsx)(V,{})}),Object(g.jsx)(v.b,{exact:!0,path:"/search",element:Object(g.jsx)(je,{})})]})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ve=a(14),ge=a(11),Ne=a(6),ke=Object(l.a)({name:"artists",initialState:{topUserArtist:[]},reducers:{setTopUserArtist:function(e,t){e.topUserArtist=t.payload}}}),Ie=(ke.actions.setTopUserArtist,{authorization:m,user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{data:[],isLoading:!1,error:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U:return Object(Ne.a)(Object(Ne.a)({},e),{},{isLoading:!0});case z:return Object(Ne.a)(Object(Ne.a)({},e),{},{isLoading:!1,error:null,data:Object(ge.a)(t.user)});case B:return Object(Ne.a)(Object(Ne.a)({},e),{},{isLoading:!1,error:t.error});default:return e}},playlists:Z,artists:ke.reducer}),Se=a(59),Te=a(28),we=Object(ve.combineReducers)(Ie),Pe=[Te.a],Ce=Object(ve.createStore)(we,Object(Se.composeWithDevTools)(ve.applyMiddleware.apply(void 0,Pe)));i.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(r.a,{store:Ce,children:Object(g.jsx)(_e,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},65:function(e,t,a){},66:function(e,t,a){},70:function(e,t,a){},72:function(e,t,a){},89:function(e,t,a){},90:function(e,t,a){},91:function(e,t,a){},92:function(e,t,a){},93:function(e,t,a){},94:function(e,t,a){},95:function(e,t,a){},96:function(e,t,a){},97:function(e,t,a){},98:function(e,t,a){},99:function(e,t,a){}},[[104,1,2]]]);
//# sourceMappingURL=main.008a75f6.chunk.js.map